/*!
 SearchPanes 1.3.0
 2019-2020 SpryMedia Ltd - datatables.net/license
*/
(function(){var h,s,t,l=function(a,b,e,c,g,d){var f=this;void 0===d&&(d=null);if(!s||!s.versionCheck||!s.versionCheck("1.10.0"))throw Error("SearchPane requires DataTables 1.10 or newer");if(!s.select)throw Error("SearchPane requires Select");a=new s.Api(a);this.classes=h.extend(!0,{},l.classes);this.c=h.extend(!0,{},l.defaults,b);void 0!==b&&(void 0!==b.hideCount&&void 0===b.viewCount)&&(this.c.viewCount=!this.c.hideCount);this.customPaneSettings=d;this.s={cascadeRegen:!1,clearing:!1,colOpts:[],
deselect:!1,displayed:!1,dt:a,dtPane:void 0,filteringActive:!1,forceViewTotal:!1,index:e,indexes:[],lastCascade:!1,lastSelect:!1,listSet:!1,name:void 0,redraw:!1,rowData:{arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map,totalOptions:0},scrollTop:0,searchFunction:void 0,selectPresent:!1,serverSelect:[],serverSelecting:!1,showFiltered:!1,tableLength:null,updating:!1};b=a.columns().eq(0).toArray().length;this.colExists=this.s.index<b;this.c.layout=
c;b=parseInt(c.split("-")[1],10);this.dom={buttonGroup:h("<div/>").addClass(this.classes.buttonGroup),clear:h('<button type="button">&#215;</button>').addClass(this.classes.disabledButton).attr("disabled","true").addClass(this.classes.paneButton).addClass(this.classes.clearButton),container:h("<div/>").addClass(this.classes.container).addClass(this.classes.layout+(10>b?c:c.split("-")[0]+"-9")),countButton:h('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.countButton),
dtP:h("<table><thead><tr><th>"+(this.colExists?h(a.column(this.colExists?this.s.index:0).header()).text():this.customPaneSettings.header||"Custom Pane")+"</th><th/></tr></thead></table>"),lower:h("<div/>").addClass(this.classes.subRow2).addClass(this.classes.narrowButton),nameButton:h('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.nameButton),panesContainer:g,searchBox:h("<input/>").addClass(this.classes.paneInputButton).addClass(this.classes.search),searchButton:h('<button type = "button" class="'+
this.classes.searchIcon+'"></button>').addClass(this.classes.paneButton),searchCont:h("<div/>").addClass(this.classes.searchCont),searchLabelCont:h("<div/>").addClass(this.classes.searchLabelCont),topRow:h("<div/>").addClass(this.classes.topRow),upper:h("<div/>").addClass(this.classes.subRow1).addClass(this.classes.narrowSearch)};this.s.displayed=!1;a=this.s.dt;this.selections=[];this.s.colOpts=this.colExists?this._getOptions():this._getBonusOptions();var i=this.s.colOpts,c=h('<button type="button">X</button>').addClass(this.classes.paneButton);
h(c).text(a.i18n("searchPanes.clearPane",this.c.i18n.clearPane));this.dom.container.addClass(i.className);this.dom.container.addClass(null!==this.customPaneSettings&&void 0!==this.customPaneSettings.className?this.customPaneSettings.className:"");this.s.name=void 0!==this.s.colOpts.name?this.s.colOpts.name:null!==this.customPaneSettings&&void 0!==this.customPaneSettings.name?this.customPaneSettings.name:this.colExists?h(a.column(this.s.index).header()).text():this.customPaneSettings.header||"Custom Pane";
h(g).append(this.dom.container);var p=a.table(0).node();this.s.searchFunction=function(a,b,d){if(f.selections.length===0||a.nTable!==p)return true;a=null;if(f.colExists){a=b[f.s.index];if(i.orthogonal.filter!=="filter"){a=f.s.rowData.filterMap.get(d);a instanceof h.fn.dataTable.Api&&(a=a.toArray())}}return f._search(a,d)};h.fn.dataTable.ext.search.push(this.s.searchFunction);if(this.c.clear)h(c).on("click",function(){f.dom.container.find("."+f.classes.search.replace(/ /g,".")).each(function(){h(this).val("");
h(this).trigger("input")});f.clearPane()});a.on("draw.dtsp",function(){f.adjustTopRow()});a.on("buttons-action",function(){f.adjustTopRow()});a.on("column-reorder.dtsp",function(a,b,d){f.s.index=d.mapping[f.s.index]});return this};l.prototype.addRow=function(a,b,e,c,g,d,f){for(var i,h=0,k=this.s.indexes;h<k.length;h++){var j=k[h];j.filter===b&&(i=j.index)}void 0===i&&(i=this.s.indexes.length,this.s.indexes.push({filter:b,index:i}));return this.s.dtPane.row.add({className:f,display:""!==a?a:this.emptyMessage(),
filter:b,index:i,shown:e,sort:g,total:c,type:d})};l.prototype.adjustTopRow=function(){var a=this.dom.container.find("."+this.classes.subRowsContainer.replace(/ /g,".")),b=this.dom.container.find("."+this.classes.subRow1.replace(/ /g,".")),e=this.dom.container.find("."+this.classes.subRow2.replace(/ /g,".")),c=this.dom.container.find("."+this.classes.topRow.replace(/ /g,"."));(252>h(a[0]).width()||252>h(c[0]).width())&&0!==h(a[0]).width()?(h(a[0]).addClass(this.classes.narrow),h(b[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowSearch),
h(e[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowButton)):(h(a[0]).removeClass(this.classes.narrow),h(b[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowSearch),h(e[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowButton))};l.prototype.clearData=function(){this.s.rowData={arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map,totalOptions:0}};l.prototype.clearPane=function(){this.s.dtPane.rows({selected:!0}).deselect();
this.updateTable();return this};l.prototype.destroy=function(){h(this.s.dtPane).off(".dtsp");h(this.s.dt).off(".dtsp");h(this.dom.nameButton).off(".dtsp");h(this.dom.countButton).off(".dtsp");h(this.dom.clear).off(".dtsp");h(this.dom.searchButton).off(".dtsp");h(this.dom.container).remove();for(var a=h.fn.dataTable.ext.search.indexOf(this.s.searchFunction);-1!==a;)h.fn.dataTable.ext.search.splice(a,1),a=h.fn.dataTable.ext.search.indexOf(this.s.searchFunction);void 0!==this.s.dtPane&&this.s.dtPane.destroy();
this.s.listSet=!1};l.prototype.emptyMessage=function(){var a=this.c.i18n.emptyMessage;this.c.emptyMessage&&(a=this.c.emptyMessage);!1!==this.s.colOpts.emptyMessage&&null!==this.s.colOpts.emptyMessage&&(a=this.s.colOpts.emptyMessage);return this.s.dt.i18n("searchPanes.emptyMessage",a)};l.prototype.getPaneCount=function(){return void 0!==this.s.dtPane?this.s.dtPane.rows({selected:!0}).data().toArray().length:0};l.prototype.rebuildPane=function(a,b,e,c){void 0===a&&(a=!1);void 0===b&&(b=null);void 0===
e&&(e=null);void 0===c&&(c=!1);this.clearData();var g=[];this.s.serverSelect=[];var d=null;void 0!==this.s.dtPane&&(c&&(this.s.dt.page.info().serverSide?this.s.serverSelect=this.s.dtPane.rows({selected:!0}).data().toArray():g=this.s.dtPane.rows({selected:!0}).data().toArray()),this.s.dtPane.clear().destroy(),d=h(this.dom.container).prev(),this.destroy(),this.s.dtPane=void 0,h.fn.dataTable.ext.search.push(this.s.searchFunction));this.dom.container.removeClass(this.classes.hidden);this.s.displayed=
!1;this._buildPane(!this.s.dt.page.info().serverSide?g:this.s.serverSelect,a,b,e,d);return this};l.prototype.removePane=function(){this.s.displayed=!1;h(this.dom.container).hide()};l.prototype.resize=function(a){this.c.layout=a;var b=parseInt(a.split("-")[1],10);h(this.dom.container).removeClass().addClass(this.classes.container).addClass(this.classes.layout+(10>b?a:a.split("-")[0]+"-9")).addClass(this.s.colOpts.className).addClass(null!==this.customPaneSettings&&void 0!==this.customPaneSettings.className?
this.customPaneSettings.className:"").addClass(this.classes.show);this.adjustTopRow()};l.prototype.setCascadeRegen=function(a){this.s.cascadeRegen=a};l.prototype.setClear=function(a){this.s.clearing=a};l.prototype.updatePane=function(a){void 0===a&&(a=!1);this.s.updating=!0;this._updateCommon(a);this.s.updating=!1};l.prototype.updateTable=function(){this.selections=this.s.dtPane.rows({selected:!0}).data().toArray();this._searchExtras();(this.c.cascadePanes||this.c.viewTotal)&&this.updatePane()};l.prototype._setListeners=
function(){var a=this,b=this.s.rowData,e;this.s.dtPane.on("select.dtsp",function(){clearTimeout(e);a.s.dt.page.info().serverSide&&!a.s.updating?a.s.serverSelecting||(a.s.serverSelect=a.s.dtPane.rows({selected:!0}).data().toArray(),a.s.scrollTop=h(a.s.dtPane.table().node()).parent()[0].scrollTop,a.s.selectPresent=!0,a.s.dt.draw(!1)):(h(a.dom.clear).removeClass(a.classes.disabledButton).attr("disabled","false"),a.s.updating||(a.s.selectPresent=!0,a._makeSelection(),a.s.selectPresent=!1))});this.s.dtPane.on("deselect.dtsp",
function(){e=setTimeout(function(){a.s.dt.page.info().serverSide&&!a.s.updating?a.s.serverSelecting||(a.s.serverSelect=a.s.dtPane.rows({selected:!0}).data().toArray(),a.s.deselect=!0,a.s.dt.draw(!1)):(a.s.deselect=!0,0===a.s.dtPane.rows({selected:!0}).data().toArray().length&&h(a.dom.clear).addClass(a.classes.disabledButton).attr("disabled","true"),a._makeSelection(),a.s.deselect=!1,a.s.dt.state.save())},50)});this.s.dt.on("stateSaveParams.dtsp",function(c,e,d){if(h.isEmptyObject(d))a.s.dtPane.state.clear();
else{var c=[],f,i,p,k;void 0!==a.s.dtPane&&(c=a.s.dtPane.rows({selected:!0}).data().map(function(a){return a.filter.toString()}).toArray(),f=h(a.dom.searchBox).val(),i=a.s.dtPane.order(),p=b.binsOriginal,k=b.arrayOriginal);void 0===d.searchPanes&&(d.searchPanes={});void 0===d.searchPanes.panes&&(d.searchPanes.panes=[]);for(e=0;e<d.searchPanes.panes.length;e++)d.searchPanes.panes[e].id===a.s.index&&(d.searchPanes.panes.splice(e,1),e--);d.searchPanes.panes.push({arrayFilter:k,bins:p,id:a.s.index,order:i,
searchTerm:f,selected:c})}});this.s.dtPane.on("user-select.dtsp",function(a,b,d,f,e){e.stopPropagation()});this.s.dtPane.on("draw.dtsp",function(){a.adjustTopRow()});h(this.dom.nameButton).on("click.dtsp",function(){var b=a.s.dtPane.order()[0][1];a.s.dtPane.order([0,"asc"===b?"desc":"asc"]).draw();a.s.dt.state.save()});h(this.dom.countButton).on("click.dtsp",function(){var b=a.s.dtPane.order()[0][1];a.s.dtPane.order([1,"asc"===b?"desc":"asc"]).draw();a.s.dt.state.save()});h(this.dom.clear).on("click.dtsp",
function(){a.dom.container.find("."+a.classes.search.replace(/ /g,".")).each(function(){h(this).val("");h(this).trigger("input")});a.clearPane()});h(this.dom.searchButton).on("click.dtsp",function(){h(a.dom.searchBox).focus()});h(this.dom.searchBox).on("input.dtsp",function(){var b=h(a.dom.searchBox).val();a.s.dtPane.search(b).draw();0<b.length||0===b.length&&0<a.s.dtPane.rows({selected:!0}).data().toArray().length?a.dom.clear.removeClass(a.classes.disabledButton).attr("disabled","false"):a.dom.clear.addClass(a.classes.disabledButton).attr("disabled",
"true");a.s.dt.state.save()});this.s.dt.state.save();return!0};l.prototype._addOption=function(a,b,e,c,g,d){if(Array.isArray(a)||a instanceof s.Api)if(a instanceof s.Api&&(a=a.toArray(),b=b.toArray()),a.length===b.length)for(var f=0;f<a.length;f++)d[a[f]]?d[a[f]]++:(d[a[f]]=1,g.push({display:b[f],filter:a[f],sort:e[f],type:c[f]})),this.s.rowData.totalOptions++;else throw Error("display and filter not the same length");else"string"===typeof this.s.colOpts.orthogonal?(d[a]?d[a]++:(d[a]=1,g.push({display:b,
filter:a,sort:e,type:c})),this.s.rowData.totalOptions++):g.push({display:b,filter:a,sort:e,type:c})};l.prototype._buildPane=function(a,b,e,c,g){var d=this;void 0===a&&(a=[]);void 0===b&&(b=!1);void 0===e&&(e=null);void 0===c&&(c=null);void 0===g&&(g=null);this.selections=[];var f=this.s.dt,i=f.column(this.colExists?this.s.index:0),p=this.s.colOpts,k=this.s.rowData,j=f.i18n("searchPanes.count",this.c.i18n.count),l=f.i18n("searchPanes.countFiltered",this.c.i18n.countFiltered),r=f.state.loaded();this.s.listSet&&
(r=f.state());if(this.colExists){var o=-1;if(r&&r.searchPanes&&r.searchPanes.panes)for(var m=0;m<r.searchPanes.panes.length;m++)if(r.searchPanes.panes[m].id===this.s.index){o=m;break}if((!1===p.show||void 0!==p.show&&!0!==p.show)&&-1===o)return this.dom.container.addClass(this.classes.hidden),this.s.displayed=!1;if(!0===p.show||-1!==o)this.s.displayed=!0;if(!this.s.dt.page.info().serverSide&&(null===e||null===e.searchPanes||null===e.searchPanes.options)){if(0===k.arrayFilter.length){this._populatePane(b);
this.s.rowData.totalOptions=0;this._detailsPane();if(r&&r.searchPanes&&r.searchPanes.panes&&-1===o){this.dom.container.addClass(this.classes.hidden);this.s.displayed=!1;return}k.arrayOriginal=k.arrayTotals;k.binsOriginal=k.binsTotal}m=Object.keys(k.binsOriginal).length;b=this._uniqueRatio(m,f.rows()[0].length);if(!1===this.s.displayed&&((void 0===p.show&&null===p.threshold?b>this.c.threshold:b>p.threshold)||!0!==p.show&&1>=m)){this.dom.container.addClass(this.classes.hidden);this.s.displayed=!1;return}this.c.viewTotal&&
0===k.arrayTotals.length?(this.s.rowData.totalOptions=0,this._detailsPane()):k.binsTotal=k.bins;this.dom.container.addClass(this.classes.show);this.s.displayed=!0}else if(null!==e&&null!==e.searchPanes&&null!==e.searchPanes.options){if(void 0!==e.tableLength)this.s.tableLength=e.tableLength,this.s.rowData.totalOptions=this.s.tableLength;else if(null===this.s.tableLength||f.rows()[0].length>this.s.tableLength)this.s.tableLength=f.rows()[0].length,this.s.rowData.totalOptions=this.s.tableLength;b=f.column(this.s.index).dataSrc();
if(void 0!==e.searchPanes.options[b]){m=0;for(b=e.searchPanes.options[b];m<b.length;m++)o=b[m],this.s.rowData.arrayFilter.push({display:o.label,filter:o.value,sort:o.label,type:o.label}),this.s.rowData.bins[o.value]=this.c.viewTotal||this.c.cascadePanes?o.count:o.total,this.s.rowData.binsTotal[o.value]=o.total}m=Object.keys(k.binsTotal).length;b=this._uniqueRatio(m,this.s.tableLength);if(!1===this.s.displayed&&((void 0===p.show&&null===p.threshold?b>this.c.threshold:b>p.threshold)||!0!==p.show&&1>=
m)){this.dom.container.addClass(this.classes.hidden);this.s.displayed=!1;return}this.s.rowData.arrayOriginal=this.s.rowData.arrayFilter;this.s.rowData.binsOriginal=this.s.rowData.bins;this.s.displayed=!0}}else this.s.displayed=!0;this._displayPane();if(!this.s.listSet)this.dom.dtP.on("stateLoadParams.dt",function(a,b,d){h.isEmptyObject(f.state.loaded())&&h.each(d,function(a){delete d[a]})});null!==g&&0<h(this.dom.panesContainer).has(g).length?h(this.dom.container).insertAfter(g):h(this.dom.panesContainer).prepend(this.dom.container);
m=h.fn.dataTable.ext.errMode;h.fn.dataTable.ext.errMode="none";g=s.Scroller;this.s.dtPane=h(this.dom.dtP).DataTable(h.extend(!0,{columnDefs:[{className:"dtsp-nameColumn",data:"display",render:function(a,b,c){if(b==="sort")return c.sort;if(b==="type")return c.type;var f;(d.s.filteringActive||d.s.showFiltered)&&d.c.viewTotal||d.c.viewTotal&&d.s.forceViewTotal?f=l.replace(/{total}/,c.total):f=j.replace(/{total}/,c.total);for(f=f.replace(/{shown}/,c.shown);f.indexOf("{total}")!==-1;)f=f.replace(/{total}/,
c.total);for(;f.indexOf("{shown}")!==-1;)f=f.replace(/{shown}/,c.shown);c='<span class="'+d.classes.pill+'">'+f+"</span>";if(!d.c.viewCount||!p.viewCount)c="";return b==="filter"?typeof a==="string"&&a.match(/<[^>]*>/)!==null?a.replace(/<[^>]*>/g,""):a:'<div class="'+d.classes.nameCont+'"><span title="'+(typeof a==="string"&&a.match(/<[^>]*>/)!==null?a.replace(/<[^>]*>/g,""):a)+'" class="'+d.classes.name+'">'+a+"</span>"+c+"</div>"},targets:0,type:void 0!==f.settings()[0].aoColumns[this.s.index]?
f.settings()[0].aoColumns[this.s.index]._sManualType:null},{className:"dtsp-countColumn "+this.classes.badgePill,data:"shown",orderData:[1,2],targets:1,visible:!1},{data:"total",targets:2,visible:!1}],deferRender:!0,dom:"t",info:!1,language:this.s.dt.settings()[0].oLanguage,paging:g?!0:!1,scrollX:!1,scrollY:"200px",scroller:g?!0:!1,select:!0,stateSave:f.settings()[0].oFeatures.bStateSave?!0:!1},this.c.dtOpts,void 0!==p?p.dtOpts:{},void 0!==this.s.colOpts.options||!this.colExists?{createdRow:function(a,
b){h(a).addClass(b.className)}}:void 0,null!==this.customPaneSettings&&void 0!==this.customPaneSettings.dtOpts?this.customPaneSettings.dtOpts:{},h.fn.dataTable.versionCheck("2")?{layout:{topLeft:null,topRight:null,bottomLeft:null,bottomRight:null}}:{}));h(this.dom.dtP).addClass(this.classes.table);g="Custom Pane";this.customPaneSettings&&this.customPaneSettings.header?g=this.customPaneSettings.header:p.header?g=p.header:this.colExists&&(g=h.fn.dataTable.versionCheck("2")?f.column(this.s.index).title():
f.settings()[0].aoColumns[this.s.index].sTitle);this.dom.searchBox.attr("placeholder",g);h.fn.dataTable.select.init(this.s.dtPane);h.fn.dataTable.ext.errMode=m;if(this.colExists){var i=(i=i.search())?i.substr(1,i.length-2).split("|"):[],n=0;k.arrayFilter.forEach(function(a){""===a.filter&&n++});m=0;for(g=k.arrayFilter.length;m<g;m++){for(var i=!1,o=0,q=this.s.serverSelect;o<q.length;o++)b=q[o],b.filter===k.arrayFilter[m].filter&&(i=!0);if(this.s.dt.page.info().serverSide&&(!this.c.cascadePanes||this.c.cascadePanes&&
0!==k.bins[k.arrayFilter[m].filter]||this.c.cascadePanes&&null!==c||i)){i=this.addRow(k.arrayFilter[m].display,k.arrayFilter[m].filter,c?k.binsTotal[k.arrayFilter[m].filter]:k.bins[k.arrayFilter[m].filter],this.c.viewTotal||c?String(k.binsTotal[k.arrayFilter[m].filter]):k.bins[k.arrayFilter[m].filter],k.arrayFilter[m].sort,k.arrayFilter[m].type);o=0;for(q=this.s.serverSelect;o<q.length;o++)b=q[o],b.filter===k.arrayFilter[m].filter&&(this.s.serverSelecting=!0,i.select(),this.s.serverSelecting=!1)}else!this.s.dt.page.info().serverSide&&
k.arrayFilter[m]&&(void 0!==k.bins[k.arrayFilter[m].filter]||!this.c.cascadePanes)?this.addRow(k.arrayFilter[m].display,k.arrayFilter[m].filter,k.bins[k.arrayFilter[m].filter],k.binsTotal[k.arrayFilter[m].filter],k.arrayFilter[m].sort,k.arrayFilter[m].type):this.s.dt.page.info().serverSide||this.addRow("",n,n,"","","")}}s.select.init(this.s.dtPane);(void 0!==p.options||null!==this.customPaneSettings&&void 0!==this.customPaneSettings.options)&&this._getComparisonRows();this.s.dtPane.draw();this.adjustTopRow();
this.s.listSet||(this._setListeners(),this.s.listSet=!0);for(c=0;c<a.length;c++)if(k=a[c],void 0!==k){m=0;for(g=this.s.dtPane.rows().indexes().toArray();m<g.length;m++)i=g[m],void 0!==this.s.dtPane.row(i).data()&&k.filter===this.s.dtPane.row(i).data().filter&&(this.s.dt.page.info().serverSide?(this.s.serverSelecting=!0,this.s.dtPane.row(i).select(),this.s.serverSelecting=!1):this.s.dtPane.row(i).select())}this.s.dt.page.info().serverSide&&this.s.dtPane.search(h(this.dom.searchBox).val()).draw();if(r&&
r.searchPanes&&r.searchPanes.panes&&(null===e||1===e.draw)){this.c.cascadePanes||this._reloadSelect(r);e=0;for(r=r.searchPanes.panes;e<r.length;e++)a=r[e],a.id===this.s.index&&(h(this.dom.searchBox).val(a.searchTerm),h(this.dom.searchBox).trigger("input"),this.s.dtPane.order(a.order).draw())}this.s.dt.state.save();return!0};l.prototype._detailsPane=function(){var a=this.s.dt;this.s.rowData.arrayTotals=[];this.s.rowData.binsTotal={};var b=this.s.dt.settings()[0],a=a.rows().indexes();if(!this.s.dt.page.info().serverSide)for(var e=
0;e<a.length;e++)this._populatePaneArray(a[e],this.s.rowData.arrayTotals,b,this.s.rowData.binsTotal)};l.prototype._displayPane=function(){var a=this.dom.container,b=this.s.colOpts,e=parseInt(this.c.layout.split("-")[1],10);h(this.dom.topRow).empty();h(this.dom.dtP).empty();h(this.dom.topRow).addClass(this.classes.topRow);3<e&&h(this.dom.container).addClass(this.classes.smallGap);h(this.dom.topRow).addClass(this.classes.subRowsContainer);h(this.dom.upper).appendTo(this.dom.topRow);h(this.dom.lower).appendTo(this.dom.topRow);
h(this.dom.searchCont).appendTo(this.dom.upper);h(this.dom.buttonGroup).appendTo(this.dom.lower);(!1===this.c.dtOpts.searching||void 0!==b.dtOpts&&!1===b.dtOpts.searching||!this.c.controls||!b.controls||null!==this.customPaneSettings&&void 0!==this.customPaneSettings.dtOpts&&void 0!==this.customPaneSettings.dtOpts.searching&&!this.customPaneSettings.dtOpts.searching)&&h(this.dom.searchBox).attr("disabled","disabled").removeClass(this.classes.paneInputButton).addClass(this.classes.disabledButton).attr("disabled",
"true");h(this.dom.searchBox).appendTo(this.dom.searchCont);this._searchContSetup();this.c.clear&&(this.c.controls&&b.controls)&&h(this.dom.clear).appendTo(this.dom.buttonGroup);this.c.orderable&&(b.orderable&&this.c.controls&&b.controls)&&h(this.dom.nameButton).appendTo(this.dom.buttonGroup);this.c.viewCount&&(b.viewCount&&this.c.orderable&&b.orderable&&this.c.controls&&b.controls)&&h(this.dom.countButton).appendTo(this.dom.buttonGroup);h(this.dom.topRow).prependTo(this.dom.container);h(a).append(this.dom.dtP);
h(a).show()};l.prototype._getBonusOptions=function(){return h.extend(!0,{},l.defaults,{orthogonal:{threshold:null},threshold:null},void 0!==this.c?this.c:{})};l.prototype._getComparisonRows=function(){var a=this.s.colOpts,a=void 0!==a.options?a.options:null!==this.customPaneSettings&&void 0!==this.customPaneSettings.options?this.customPaneSettings.options:void 0;if(void 0!==a){var b=this.s.dt.rows({search:"applied"}).data().toArray(),e=this.s.dt.rows({search:"applied"}),c=this.s.dt.rows().data().toArray(),
g=this.s.dt.rows(),d=[];this.s.dtPane.clear();for(var f=0;f<a.length;f++){var i=a[f],h=""!==i.label?i.label:this.emptyMessage(),k=i.className,j=h,l="function"===typeof i.value?i.value:[],n=0,o=h,m=0;if("function"===typeof i.value){for(var q=0;q<b.length;q++)i.value.call(this.s.dt,b[q],e[0][q])&&n++;for(q=0;q<c.length;q++)i.value.call(this.s.dt,c[q],g[0][q])&&m++;"function"!==typeof l&&l.push(i.filter)}(!this.c.cascadePanes||this.c.cascadePanes&&0!==n)&&d.push(this.addRow(j,l,n,m,o,h,k))}return d}};
l.prototype._getOptions=function(){var a=this.s.dt.settings()[0].aoColumns[this.s.index].searchPanes,b=h.extend(!0,{},l.defaults,{emptyMessage:!1,orthogonal:{threshold:null},threshold:null},a);void 0!==a&&(void 0!==a.hideCount&&void 0===a.viewCount)&&(b.viewCount=!a.hideCount);return b};l.prototype._makeSelection=function(){this.updateTable();this.s.updating=!0;this.s.dt.draw();this.s.updating=!1};l.prototype._populatePane=function(a){void 0===a&&(a=!1);var b=this.s.dt;this.s.rowData.arrayFilter=
[];this.s.rowData.bins={};var e=this.s.dt.settings()[0];if(!this.s.dt.page.info().serverSide)for(var c=0,a=((this.c.cascadePanes||this.c.viewTotal)&&!this.s.clearing&&!a?b.rows({search:"applied"}).indexes():b.rows().indexes()).toArray();c<a.length;c++)this._populatePaneArray(a[c],this.s.rowData.arrayFilter,e)};l.prototype._populatePaneArray=function(a,b,e,c){void 0===c&&(c=this.s.rowData.bins);var g=this.s.colOpts;if("string"===typeof g.orthogonal)e=e.oApi._fnGetCellData(e,a,this.s.index,g.orthogonal),
this.s.rowData.filterMap.set(a,e),this._addOption(e,e,e,e,b,c);else{var d=e.oApi._fnGetCellData(e,a,this.s.index,g.orthogonal.search);null===d&&(d="");"string"===typeof d&&(d=d.replace(/<[^>]*>/g,""));this.s.rowData.filterMap.set(a,d);c[d]?c[d]++:(c[d]=1,this._addOption(d,e.oApi._fnGetCellData(e,a,this.s.index,g.orthogonal.display),e.oApi._fnGetCellData(e,a,this.s.index,g.orthogonal.sort),e.oApi._fnGetCellData(e,a,this.s.index,g.orthogonal.type),b,c));this.s.rowData.totalOptions++}};l.prototype._reloadSelect=
function(a){if(void 0!==a){for(var b,e=0;e<a.searchPanes.panes.length;e++)if(a.searchPanes.panes[e].id===this.s.index){b=e;break}if(void 0!==b)for(var e=this.s.dtPane,c=e.rows({order:"index"}).data().map(function(a){return null!==a.filter?a.filter.toString():null}).toArray(),g=0,a=a.searchPanes.panes[b].selected;g<a.length;g++){b=a[g];var d=-1;null!==b&&(d=c.indexOf(b.toString()));-1<d&&(this.s.serverSelecting=!0,e.row(d).select(),this.s.serverSelecting=!1)}}};l.prototype._search=function(a,b){for(var e=
this.s.colOpts,c=this.s.dt,g=0,d=this.selections;g<d.length;g++){var f=d[g];"string"===typeof f.filter&&"string"===typeof a&&(f.filter=f.filter.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'));if(Array.isArray(a)){if(-1!==a.indexOf(f.filter))return!0}else if("function"===typeof f.filter)if(f.filter.call(c,c.row(b).data(),b)){if("or"===e.combiner)return!0}else{if("and"===e.combiner)return!1}else if(a===f.filter||!("string"===typeof a&&0===a.length)&&a==f.filter||
null===f.filter&&"string"===typeof a&&""===a)return!0}return"and"===e.combiner?!0:!1};l.prototype._searchContSetup=function(){this.c.controls&&this.s.colOpts.controls&&h(this.dom.searchButton).appendTo(this.dom.searchLabelCont);!1===this.c.dtOpts.searching||(!1===this.s.colOpts.dtOpts.searching||null!==this.customPaneSettings&&void 0!==this.customPaneSettings.dtOpts&&void 0!==this.customPaneSettings.dtOpts.searching&&!this.customPaneSettings.dtOpts.searching)||h(this.dom.searchLabelCont).appendTo(this.dom.searchCont)};
l.prototype._searchExtras=function(){var a=this.s.updating;this.s.updating=!0;var b=this.s.dtPane.rows({selected:!0}).data().pluck("filter").toArray(),e=b.indexOf(this.emptyMessage()),c=h(this.s.dtPane.table().container());-1<e&&(b[e]="");0<b.length?c.addClass(this.classes.selected):0===b.length&&c.removeClass(this.classes.selected);this.s.updating=a};l.prototype._uniqueRatio=function(a,b){return 0<b&&(0<this.s.rowData.totalOptions&&!this.s.dt.page.info().serverSide||this.s.dt.page.info().serverSide&&
0<this.s.tableLength)?a/this.s.rowData.totalOptions:1};l.prototype._updateCommon=function(a){void 0===a&&(a=!1);if(!this.s.dt.page.info().serverSide&&void 0!==this.s.dtPane&&(!this.s.filteringActive||this.c.cascadePanes||!0===a)&&(!0!==this.c.cascadePanes||!0!==this.s.selectPresent)&&(!this.s.lastSelect||!this.s.lastCascade)){var b=this.s.colOpts,e=this.s.dtPane.rows({selected:!0}).data().toArray(),a=h(this.s.dtPane.table().node()).parent()[0].scrollTop,c=this.s.rowData;this.s.dtPane.clear();if(this.colExists){0===
c.arrayFilter.length?this._populatePane(!this.s.filteringActive):this.c.cascadePanes&&this.s.dt.rows().data().toArray().length===this.s.dt.rows({search:"applied"}).data().toArray().length?(c.arrayFilter=c.arrayOriginal,c.bins=c.binsOriginal):(this.c.viewTotal||this.c.cascadePanes)&&this._populatePane(!this.s.filteringActive);this.c.viewTotal?this._detailsPane():c.binsTotal=c.bins;this.c.viewTotal&&!this.c.cascadePanes&&(c.arrayFilter=c.arrayTotals);for(var g=function(a){if(a&&(c.bins[a.filter]!==
void 0&&c.bins[a.filter]!==0&&d.c.cascadePanes||!d.c.cascadePanes||d.s.clearing)){var b=d.addRow(a.display,a.filter,!d.c.viewTotal?c.bins[a.filter]:c.bins[a.filter]!==void 0?c.bins[a.filter]:0,d.c.viewTotal?String(c.binsTotal[a.filter]):c.bins[a.filter],a.sort,a.type),f=e.findIndex(function(b){return b.filter===a.filter});if(f!==-1){b.select();e.splice(f,1)}}},d=this,f=0,i=c.arrayFilter;f<i.length;f++)g(i[f])}if(void 0!==b.searchPanes&&void 0!==b.searchPanes.options||void 0!==b.options||null!==this.customPaneSettings&&
void 0!==this.customPaneSettings.options){g=function(a){var b=e.findIndex(function(b){if(b.display===a.data().display)return!0});-1!==b&&(a.select(),e.splice(b,1))};f=0;for(i=this._getComparisonRows();f<i.length;f++)b=i[f],g(b)}for(g=0;g<e.length;g++)b=e[g],b=this.addRow(b.display,b.filter,0,this.c.viewTotal?b.total:0,b.display,b.display),this.s.updating=!0,b.select(),this.s.updating=!1;this.s.dtPane.draw();this.s.dtPane.table().node().parentNode.scrollTop=a}};l.version="1.3.0";l.classes={buttonGroup:"dtsp-buttonGroup",
buttonSub:"dtsp-buttonSub",clear:"dtsp-clear",clearAll:"dtsp-clearAll",clearButton:"clearButton",container:"dtsp-searchPane",countButton:"dtsp-countButton",disabledButton:"dtsp-disabledButton",hidden:"dtsp-hidden",hide:"dtsp-hide",layout:"dtsp-",name:"dtsp-name",nameButton:"dtsp-nameButton",nameCont:"dtsp-nameCont",narrow:"dtsp-narrow",paneButton:"dtsp-paneButton",paneInputButton:"dtsp-paneInputButton",pill:"dtsp-pill",search:"dtsp-search",searchCont:"dtsp-searchCont",searchIcon:"dtsp-searchIcon",
searchLabelCont:"dtsp-searchButtonCont",selected:"dtsp-selected",smallGap:"dtsp-smallGap",subRow1:"dtsp-subRow1",subRow2:"dtsp-subRow2",subRowsContainer:"dtsp-subRowsContainer",title:"dtsp-title",topRow:"dtsp-topRow"};l.defaults={cascadePanes:!1,clear:!0,combiner:"or",controls:!0,container:function(a){return a.table().container()},dtOpts:{},emptyMessage:null,hideCount:!1,i18n:{clearPane:"&times;",count:"{total}",countFiltered:"{shown} ({total})",emptyMessage:"<em>No data</em>"},layout:"auto",name:void 0,
orderable:!0,orthogonal:{display:"display",filter:"filter",hideCount:!1,search:"filter",show:void 0,sort:"sort",threshold:0.6,type:"type",viewCount:!0},preSelect:[],threshold:0.6,viewCount:!0,viewTotal:!1};t=l;var j,q,u,n=function(a,b,e){var c=this;void 0===e&&(e=!1);this.regenerating=!1;if(!q||!q.versionCheck||!q.versionCheck("1.10.0"))throw Error("SearchPane requires DataTables 1.10 or newer");if(!q.select)throw Error("SearchPane requires Select");var g=new q.Api(a);this.classes=j.extend(!0,{},
n.classes);this.c=j.extend(!0,{},n.defaults,b);this.dom={clearAll:j('<button type="button">Clear All</button>').addClass(this.classes.clearAll),container:j("<div/>").addClass(this.classes.panes).text(g.i18n("searchPanes.loadMessage",this.c.i18n.loadMessage)),emptyMessage:j("<div/>").addClass(this.classes.emptyMessage),options:j("<div/>").addClass(this.classes.container),panes:j("<div/>").addClass(this.classes.container),title:j("<div/>").addClass(this.classes.title),titleRow:j("<div/>").addClass(this.classes.titleRow),
wrapper:j("<div/>")};this.s={colOpts:[],dt:g,filterCount:0,filterPane:-1,page:0,panes:[],selectionList:[],serverData:{},stateRead:!1,updating:!1};if(void 0===g.settings()[0]._searchPanes){this._getState();if(this.s.dt.page.info().serverSide)g.on("preXhr.dt",function(a,b,e){void 0===e.searchPanes&&(e.searchPanes={});a=0;for(b=c.s.selectionList;a<b.length;a++){var g=b[a],h=c.s.dt.column(g.index).dataSrc();void 0===e.searchPanes[h]&&(e.searchPanes[h]={});for(var j=0;j<g.rows.length;j++)e.searchPanes[h][j]=
g.rows[j].filter}});g.on("xhr",function(a,b,e){e&&(e.searchPanes&&e.searchPanes.options)&&(c.s.serverData=e,c.s.serverData.tableLength=e.recordsTotal,c._serverTotals())});g.settings()[0]._searchPanes=this;this.dom.clearAll.text(g.i18n("searchPanes.clearMessage",this.c.i18n.clearMessage));if(this.s.dt.settings()[0]._bInitComplete||e)this._paneDeclare(g,a,b);else g.one("preInit.dt",function(){c._paneDeclare(g,a,b)});return this}};n.prototype.clearSelections=function(){this.dom.container.find("."+this.classes.search.replace(/ /g,
".")).each(function(){j(this).val("");j(this).trigger("input")});for(var a=[],b=0,e=this.s.panes;b<e.length;b++){var c=e[b];void 0!==c.s.dtPane&&a.push(c.clearPane())}return a};n.prototype.getNode=function(){return this.dom.container};n.prototype.rebuild=function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!1);j(this.dom.emptyMessage).remove();var e=[];!1===a&&j(this.dom.panes).empty();for(var c=0,g=this.s.panes;c<g.length;c++){var d=g[c];!1!==a&&d.s.index!==a||(d.clearData(),e.push(d.rebuildPane(void 0!==
this.s.selectionList[this.s.selectionList.length-1]?d.s.index===this.s.selectionList[this.s.selectionList.length-1].index:!1,this.s.dt.page.info().serverSide?this.s.serverData:void 0,null,b)),j(this.dom.panes).append(d.dom.container))}this.c.cascadePanes||this.c.viewTotal?this.redrawPanes(!0):this._updateSelection();this._updateFilterCount();this._attachPaneContainer();this.s.dt.draw();this.resizePanes();return 1===e.length?e[0]:e};n.prototype.redrawPanes=function(a){void 0===a&&(a=!1);var b=this.s.dt;
if(!this.s.updating&&!this.s.dt.page.info().serverSide){for(var e=!0,c=this.s.filterPane,g=null,d=0,f=this.s.panes;d<f.length;d++){var i=f[d];void 0!==i.s.dtPane&&(g+=i.s.dtPane.rows({selected:!0}).data().toArray().length)}if(0===g&&b.rows({search:"applied"}).data().toArray().length===b.rows().data().toArray().length)e=!1;else if(this.c.viewTotal){d=0;for(f=this.s.panes;d<f.length;d++)if(i=f[d],void 0!==i.s.dtPane){var h=i.s.dtPane.rows({selected:!0}).data().toArray().length;if(0===h)for(var k=0,
j=this.s.selectionList;k<j.length;k++){var l=j[k];l.index===i.s.index&&0!==l.rows.length&&(h=l.rows.length)}0<h&&-1===c?c=i.s.index:0<h&&(c=null)}0===g&&(c=null)}f=void 0;d=[];if(this.regenerating){b=-1;1===d.length&&(null!==g&&0!==g)&&(b=d[0].index);a=0;for(d=this.s.panes;a<d.length;a++)if(i=d[a],void 0!==i.s.dtPane){f=!0;i.s.filteringActive=!0;if(-1!==c&&null!==c&&c===i.s.index||!1===e||i.s.index===b)f=!1,i.s.filteringActive=!1;i.updatePane(!f?f:e)}this._updateFilterCount()}else{h=0;for(k=this.s.panes;h<
k.length;h++)if(i=k[h],i.s.selectPresent){this.s.selectionList.push({index:i.s.index,rows:i.s.dtPane.rows({selected:!0}).data().toArray(),protect:!1});b.state.save();break}else i.s.deselect&&(f=i.s.index,j=i.s.dtPane.rows({selected:!0}).data().toArray(),0<j.length&&this.s.selectionList.push({index:i.s.index,rows:j,protect:!0}));if(0<this.s.selectionList.length){b=this.s.selectionList[this.s.selectionList.length-1].index;h=0;for(k=this.s.panes;h<k.length;h++)i=k[h],i.s.lastSelect=i.s.index===b}for(i=
0;i<this.s.selectionList.length;i++)if(this.s.selectionList[i].index!==f||!0===this.s.selectionList[i].protect){b=!1;for(h=i+1;h<this.s.selectionList.length;h++)this.s.selectionList[h].index===this.s.selectionList[i].index&&(b=!0);b||(d.push(this.s.selectionList[i]),this.s.selectionList[i].protect=!1)}b=-1;1===d.length&&(null!==g&&0!==g)&&(b=d[0].index);h=0;for(k=this.s.panes;h<k.length;h++)if(i=k[h],void 0!==i.s.dtPane){f=!0;i.s.filteringActive=!0;if(-1!==c&&null!==c&&c===i.s.index||!1===e||i.s.index===
b)f=!1,i.s.filteringActive=!1;i.updatePane(!f?!1:e)}this._updateFilterCount();if(0<d.length&&(d.length<this.s.selectionList.length||a)){this._cascadeRegen(d,g);b=d[d.length-1].index;c=0;for(a=this.s.panes;c<a.length;c++)i=a[c],i.s.lastSelect=i.s.index===b}else if(0<d.length){i=0;for(a=this.s.panes;i<a.length;i++)if(d=a[i],void 0!==d.s.dtPane){f=!0;d.s.filteringActive=!0;if(-1!==c&&null!==c&&c===d.s.index||!1===e||d.s.index===b)f=!1,d.s.filteringActive=!1;d.updatePane(!f?f:e)}}}if(!e||0===g)this.s.selectionList=
[]}};n.prototype.resizePanes=function(){if("auto"===this.c.layout){for(var a=j(this.s.dt.searchPanes.container()).width(),b=Math.floor(a/260),a=1,e=0,c=[],g=0,d=this.s.panes;g<d.length;g++){var f=d[g];f.s.displayed&&c.push(f.s.index)}f=c.length;if(b===f)a=b;else for(;1<b;b--)if(g=f%b,0===g){a=b;e=0;break}else g>e&&(a=b,e=g);c=0!==e?c.slice(c.length-e,c.length):[];b=0;for(g=this.s.panes;b<g.length;b++)f=g[b],f.s.displayed&&(d="columns-"+(-1===c.indexOf(f.s.index)?a:e),f.resize(d))}else{a=0;for(e=this.s.panes;a<
e.length;a++)f=e[a],f.adjustTopRow()}return this};n.prototype._attach=function(){var a=this;j(this.dom.container).removeClass(this.classes.hide);j(this.dom.titleRow).removeClass(this.classes.hide);j(this.dom.titleRow).remove();j(this.dom.title).appendTo(this.dom.titleRow);this.c.clear&&(j(this.dom.clearAll).appendTo(this.dom.titleRow),j(this.dom.clearAll).on("click.dtsps",function(){a.clearSelections()}));j(this.dom.titleRow).appendTo(this.dom.container);for(var b=0,e=this.s.panes;b<e.length;b++)j(e[b].dom.container).appendTo(this.dom.panes);
j(this.dom.panes).appendTo(this.dom.container);0===j("div."+this.classes.container).length&&j(this.dom.container).prependTo(this.s.dt);return this.dom.container};n.prototype._attachExtras=function(){j(this.dom.container).removeClass(this.classes.hide);j(this.dom.titleRow).removeClass(this.classes.hide);j(this.dom.titleRow).remove();j(this.dom.title).appendTo(this.dom.titleRow);this.c.clear&&j(this.dom.clearAll).appendTo(this.dom.titleRow);j(this.dom.titleRow).appendTo(this.dom.container);return this.dom.container};
n.prototype._attachMessage=function(){var a;try{a=this.s.dt.i18n("searchPanes.emptyPanes",this.c.i18n.emptyPanes)}catch(b){a=null}if(null===a)j(this.dom.container).addClass(this.classes.hide),j(this.dom.titleRow).removeClass(this.classes.hide);else return j(this.dom.container).removeClass(this.classes.hide),j(this.dom.titleRow).addClass(this.classes.hide),j(this.dom.emptyMessage).text(a),this.dom.emptyMessage.appendTo(this.dom.container),this.dom.container};n.prototype._attachPaneContainer=function(){for(var a=
0,b=this.s.panes;a<b.length;a++)if(!0===b[a].s.displayed)return this._attach();return this._attachMessage()};n.prototype._cascadeRegen=function(a,b){this.regenerating=!0;var e=-1;1===a.length&&(null!==b&&0!==b)&&(e=a[0].index);for(var c=0,g=this.s.panes;c<g.length;c++){var d=g[c];d.setCascadeRegen(!0);d.setClear(!0);(void 0!==d.s.dtPane&&d.s.index===e||void 0!==d.s.dtPane)&&d.clearPane();d.setClear(!1)}this.s.dt.draw();e=this.s.dt.rows({search:"applied"}).data().toArray().length;c=this.s.dt.rows().data().toArray().length;
if(c!==e)for(var g=0,f=this.s.panes;g<f.length;g++)d=f[g],d.s.forceViewTotal=!0;g=0;for(f=this.s.panes;g<f.length;g++)d=f[g],d.updatePane(!0);this._makeCascadeSelections(a);this.s.selectionList=a;g=0;for(f=this.s.panes;g<f.length;g++)d=f[g],d.setCascadeRegen(!1);this.regenerating=!1;if(c!==e){e=0;for(c=this.s.panes;e<c.length;e++)d=c[e],d.s.forceViewTotal=!1}};n.prototype._checkMessage=function(){for(var a=0,b=this.s.panes;a<b.length;a++)if(!0===b[a].s.displayed)return;return this._attachMessage()};
n.prototype._getState=function(){var a=this.s.dt.state.loaded();a&&(a.searchPanes&&void 0!==a.searchPanes.selectionList)&&(this.s.selectionList=a.searchPanes.selectionList)};n.prototype._makeCascadeSelections=function(a){for(var b=0;b<a.length;b++)for(var e=function(d){if(d.s.index===a[b].index&&void 0!==d.s.dtPane){b===a.length-1&&(d.s.lastCascade=!0);0<d.s.dtPane.rows({selected:!0}).data().toArray().length&&void 0!==d.s.dtPane&&(d.setClear(!0),d.clearPane(),d.setClear(!1));for(var e=function(a){var b=
false;d.s.dtPane.rows().every(function(c){if(d.s.dtPane.row(c).data()!==void 0&&a!==void 0&&d.s.dtPane.row(c).data().filter===a.filter){b=true;d.s.dtPane.row(c).select()}});b||d.addRow(a.display,a.filter,0,a.total,a.sort,a.type,a.className).select()},g=0,h=a[b].rows;g<h.length;g++)e(h[g]);d.s.dtPane.draw();c._updateFilterCount();d.s.lastCascade=!1}},c=this,g=0,d=this.s.panes;g<d.length;g++)e(d[g]);this.s.dt.state.save()};n.prototype._paneDeclare=function(a,b,e){var c=this;a.columns(0<this.c.columns.length?
this.c.columns:void 0).eq(0).each(function(a){c.s.panes.push(new t(b,e,a,c.c.layout,c.dom.panes))});for(var g=a.columns().eq(0).toArray().length,d=this.c.panes.length,f=0;f<d;f++)this.s.panes.push(new t(b,e,g+f,this.c.layout,this.dom.panes,this.c.panes[f]));if(0<this.c.order.length){g=this.c.order.map(function(a){return c._findPane(a)});this.dom.panes.empty();this.s.panes=g;g=0;for(d=this.s.panes;g<d.length;g++)this.dom.panes.append(d[g].dom.container)}this.s.dt.settings()[0]._bInitComplete?this._startup(a):
this.s.dt.settings()[0].aoInitComplete.push({fn:function(){c._startup(a)}})};n.prototype._findPane=function(a){for(var b=0,e=this.s.panes;b<e.length;b++){var c=e[b];if(a===c.s.name)return c}};n.prototype._serverTotals=function(){for(var a=!1,b=!1,e=this.s.dt,c=0,g=this.s.panes;c<g.length;c++){var d=g[c];if(d.s.selectPresent){this.s.selectionList.push({index:d.s.index,rows:d.s.dtPane.rows({selected:!0}).data().toArray(),protect:!1});e.state.save();d.s.selectPresent=!1;a=!0;break}else d.s.deselect&&
(b=d.s.dtPane.rows({selected:!0}).data().toArray(),0<b.length&&this.s.selectionList.push({index:d.s.index,rows:b,protect:!0}),b=a=!0)}if(a){e=[];for(c=0;c<this.s.selectionList.length;c++){d=!1;for(g=c+1;g<this.s.selectionList.length;g++)this.s.selectionList[g].index===this.s.selectionList[c].index&&(d=!0);if(!d){for(var g=!1,a=0,f=this.s.panes;a<f.length;a++)d=f[a],d.s.index===this.s.selectionList[c].index&&0<d.s.dtPane.rows({selected:!0}).data().toArray().length&&(g=!0);g&&e.push(this.s.selectionList[c])}}this.s.selectionList=
e}else this.s.selectionList=[];e=-1;if(b&&1===this.s.selectionList.length){b=0;for(c=this.s.panes;b<c.length;b++)d=c[b],d.s.lastSelect=!1,d.s.deselect=!1,void 0!==d.s.dtPane&&0<d.s.dtPane.rows({selected:!0}).data().toArray().length&&(e=d.s.index)}else if(0<this.s.selectionList.length){b=this.s.selectionList[this.s.selectionList.length-1].index;c=0;for(g=this.s.panes;c<g.length;c++)d=g[c],d.s.lastSelect=d.s.index===b,d.s.deselect=!1}else if(0===this.s.selectionList.length){b=0;for(c=this.s.panes;b<
c.length;b++)d=c[b],d.s.lastSelect=!1,d.s.deselect=!1}j(this.dom.panes).empty();b=0;for(c=this.s.panes;b<c.length;b++)d=c[b],d.s.lastSelect?d._setListeners():d.rebuildPane(void 0,this.s.dt.page.info().serverSide?this.s.serverData:void 0,d.s.index===e?!0:null,!0),j(this.dom.panes).append(d.dom.container),void 0!==d.s.dtPane&&(j(d.s.dtPane.table().node()).parent()[0].scrollTop=d.s.scrollTop,j.fn.dataTable.select.init(d.s.dtPane))};n.prototype._startup=function(a){var b=this;j(this.dom.container).text("");
this._attachExtras();j(this.dom.container).append(this.dom.panes);j(this.dom.panes).empty();var e=this.s.dt.state.loaded();if(this.c.viewTotal&&!this.c.cascadePanes&&null!==e&&void 0!==e&&void 0!==e.searchPanes&&void 0!==e.searchPanes.panes){for(var c=!1,g=0,d=e.searchPanes.panes;g<d.length;g++){var f=d[g];if(0<f.selected.length){c=!0;break}}if(c){c=0;for(g=this.s.panes;c<g.length;c++)f=g[c],f.s.showFiltered=!0}}c=0;for(g=this.s.panes;c<g.length;c++)f=g[c],f.rebuildPane(void 0,0<Object.keys(this.s.serverData).length?
this.s.serverData:void 0),j(this.dom.panes).append(f.dom.container);"auto"===this.c.layout&&this.resizePanes();!this.s.stateRead&&(null!==e&&void 0!==e)&&(this.s.dt.page(e.start/this.s.dt.page.len()),this.s.dt.draw("page"));this.s.stateRead=!0;if(this.c.viewTotal&&!this.c.cascadePanes){e=0;for(c=this.s.panes;e<c.length;e++)f=c[e],f.updatePane()}this._updateFilterCount();this._checkMessage();a.on("preDraw.dtsps",function(){if(!b.s.updating){b._updateFilterCount();(b.c.cascadePanes||b.c.viewTotal)&&
!b.s.dt.page.info().serverSide?b.redrawPanes(b.c.viewTotal):b._updateSelection();b.s.filterPane=-1}});j(window).on("resize.dtsp",q.util.throttle(function(){b.resizePanes()}));this.s.dt.on("stateSaveParams.dtsp",function(a,d,c){if(c.searchPanes===void 0)c.searchPanes={};c.searchPanes.selectionList=b.s.selectionList});if(this.s.dt.page.info().serverSide)a.off("page"),a.on("page",function(){b.s.page=b.s.dt.page()}),a.off("preXhr.dt"),a.on("preXhr.dt",function(a,d,c){if(c.searchPanes===void 0)c.searchPanes=
{};for(var d=a=0,e=b.s.panes;d<e.length;d++){var f=e[d],g=b.s.dt.column(f.s.index).dataSrc();c.searchPanes[g]===void 0&&(c.searchPanes[g]={});if(f.s.dtPane!==void 0)for(var f=f.s.dtPane.rows({selected:true}).data().toArray(),h=0;h<f.length;h++){c.searchPanes[g][h]=f[h].filter;a++}}b.c.viewTotal&&b._prepViewTotal(a);if(a>0){if(a!==b.s.filterCount){c.start=0;b.s.page=0}else c.start=b.s.page*b.s.dt.page.len();b.s.dt.page(b.s.page);b.s.filterCount=a}});else a.on("preXhr.dt",function(){for(var a=0,d=b.s.panes;a<
d.length;a++)d[a].clearData()});this.s.dt.on("xhr",function(){var a=false;if(!b.s.dt.page.info().serverSide)b.s.dt.one("preDraw",function(){if(!a){var d=b.s.dt.page();a=true;b.s.updating=true;j(b.dom.panes).empty();for(var c=0,e=b.s.panes;c<e.length;c++){var f=e[c];f.clearData();f.rebuildPane(b.s.selectionList[b.s.selectionList.length-1]!==void 0?f.s.index===b.s.selectionList[b.s.selectionList.length-1].index:false,void 0,void 0,true);j(b.dom.panes).append(f.dom.container)}b.s.dt.page.info().serverSide||
b.s.dt.draw();b.s.updating=false;b.c.cascadePanes||b.c.viewTotal?b.redrawPanes(b.c.cascadePanes):b._updateSelection();b._checkMessage();b.s.dt.one("draw",function(){b.s.updating=true;b.s.dt.page(d).draw(false);b.s.updating=false})}})});e=0;for(c=this.s.panes;e<c.length;e++)if(f=c[e],void 0!==f&&void 0!==f.s.dtPane&&(void 0!==f.s.colOpts.preSelect&&0<f.s.colOpts.preSelect.length||null!==f.customPaneSettings&&void 0!==f.customPaneSettings.preSelect&&0<f.customPaneSettings.preSelect.length)){g=f.s.dtPane.rows().data().toArray().length;
for(d=0;d<g;d++)(-1!==f.s.colOpts.preSelect.indexOf(f.s.dtPane.cell(d,0).data())||null!==f.customPaneSettings&&void 0!==f.customPaneSettings.preSelect&&-1!==f.customPaneSettings.preSelect.indexOf(f.s.dtPane.cell(d,0).data()))&&f.s.dtPane.row(d).select();f.updateTable()}if(void 0!==this.s.selectionList&&0<this.s.selectionList.length){e=this.s.selectionList[this.s.selectionList.length-1].index;c=0;for(g=this.s.panes;c<g.length;c++)f=g[c],f.s.lastSelect=f.s.index===e}0<this.s.selectionList.length&&this.c.cascadePanes&&
this._cascadeRegen(this.s.selectionList,this.s.selectionList.length);this._updateFilterCount();a.on("destroy.dtsps",function(){for(var d=0,c=b.s.panes;d<c.length;d++)c[d].destroy();a.off(".dtsps");j(b.dom.clearAll).off(".dtsps");j(b.dom.container).remove();b.clearSelections()});if(this.c.clear)j(this.dom.clearAll).on("click.dtsps",function(){b.clearSelections()});a.settings()[0]._searchPanes=this};n.prototype._prepViewTotal=function(a){for(var b=this.s.filterPane,e=!1,c=0,g=this.s.panes;c<g.length;c++){var d=
g[c];if(void 0!==d.s.dtPane){var f=d.s.dtPane.rows({selected:!0}).data().toArray().length;0<f&&-1===b?(b=d.s.index,e=!0):0<f&&(b=null)}}null!==a&&0!==a&&(b=null);a=0;for(c=this.s.panes;a<c.length;a++)if(d=c[a],void 0!==d.s.dtPane&&(d.s.filteringActive=!0,-1!==b&&null!==b&&b===d.s.index||!1===e))d.s.filteringActive=!1};n.prototype._updateFilterCount=function(){for(var a=0,b=0,e=this.s.panes;b<e.length;b++){var c=e[b];void 0!==c.s.dtPane&&(a+=c.getPaneCount())}b=this.s.dt.i18n("searchPanes.title",this.c.i18n.title,
a);j(this.dom.title).text(b);void 0!==this.c.filterChanged&&"function"===typeof this.c.filterChanged&&this.c.filterChanged.call(this.s.dt,a);0===a?j(this.dom.clearAll).addClass(this.classes.disabledButton).attr("disabled","true"):j(this.dom.clearAll).removeClass(this.classes.disabledButton).attr("disabled","false")};n.prototype._updateSelection=function(){this.s.selectionList=[];for(var a=0,b=this.s.panes;a<b.length;a++){var e=b[a];void 0!==e.s.dtPane&&this.s.selectionList.push({index:e.s.index,rows:e.s.dtPane.rows({selected:!0}).data().toArray(),
protect:!1})}this.s.dt.state.save()};n.version="1.3.0";n.classes={clear:"dtsp-clear",clearAll:"dtsp-clearAll",container:"dtsp-searchPanes",disabledButton:"dtsp-disabledButton",emptyMessage:"dtsp-emptyMessage",hide:"dtsp-hidden",panes:"dtsp-panesContainer",search:"dtsp-search",title:"dtsp-title",titleRow:"dtsp-titleRow"};n.defaults={cascadePanes:!1,clear:!0,container:function(a){return a.table().container()},columns:[],filterChanged:void 0,i18n:{clearMessage:"Clear All",clearPane:"&times;",collapse:{"0":"SearchPanes",
_:"SearchPanes (%d)"},count:"{total}",countFiltered:"{shown} ({total})",emptyMessage:"<em>No data</em>",emptyPanes:"No SearchPanes",loadMessage:"Loading Search Panes...",title:"Filters Active - %d"},layout:"auto",order:[],panes:[],viewTotal:!1};u=n;var v=function(a,b,e){function c(a,b,c){void 0===b&&(b=null);void 0===c&&(c=!1);a=new g.Api(a);b=b?b:a.init().searchPanes||g.defaults.searchPanes;return(new u(a,b,c)).getNode()}h=a;s=a.fn.dataTable;j=a;var g=q=a.fn.dataTable;a.fn.dataTable.SearchPanes=
u;a.fn.DataTable.SearchPanes=u;a.fn.dataTable.SearchPane=t;a.fn.DataTable.SearchPane=t;b=a.fn.dataTable.Api.register;b("searchPanes()",function(){return this});b("searchPanes.clearSelections()",function(){return this.iterator("table",function(a){a._searchPanes&&a._searchPanes.clearSelections()})});b("searchPanes.rebuildPane()",function(a,b){return this.iterator("table",function(c){c._searchPanes&&c._searchPanes.rebuild(a,b)})});b("searchPanes.resizePanes()",function(){var a=this.context[0];return a._searchPanes?
a._searchPanes.resizePanes():null});b("searchPanes.container()",function(){var a=this.context[0];return a._searchPanes?a._searchPanes.getNode():null});a.fn.dataTable.ext.buttons.searchPanesClear={text:"Clear Panes",action:function(a,b){b.searchPanes.clearSelections()}};a.fn.dataTable.ext.buttons.searchPanes={action:function(a,b,c,e){a.stopPropagation();this.popover(e._panes.getNode(),{align:"dt-container"});e._panes.rebuild(void 0,!0)},config:{},init:function(b,c,e){var g=new a.fn.dataTable.SearchPanes(b,
a.extend({filterChanged:function(a){b.button(c).text(b.i18n("searchPanes.collapse",g.c.i18n.collapse,a))}},e.config)),h=b.i18n("searchPanes.collapse",g.c.i18n.collapse,0);b.button(c).text(h);e._panes=g},text:"Search Panes"};a(e).on("preInit.dt.dtsp",function(a,b){if("dt"===a.namespace&&(b.oInit.searchPanes||g.defaults.searchPanes))b._searchPanes||c(b,null,!0)});g.ext.feature.push({cFeature:"P",fnInit:c});g.ext.features&&g.ext.features.register("searchPanes",c)};"function"===typeof define&&define.amd?
define(["jquery","datatables.net"],function(a){return v(a,window,document)}):"object"===typeof exports?module.exports=function(a,b){a||(a=window);if(!b||!b.fn.dataTable)b=require("datatables.net")(a,b).$;return v(b,a,a.document)}:v(window.jQuery,window,document)})();
